language: python
os: 
  - linux
  - osx
  - windows
python:
- '2.7'
- '3.4'
- '3.5'
- 3.5-dev
- '3.6'
- 3.6-dev
matrix:
  include:
    - os: osx
      before_install:
        - if [ -d "$HOME/miniconda3" ] && [ -e "$HOME/miniconda3/bin/conda" ]; then
            echo "Miniconda install already present from cache: $HOME/miniconda3"
            rm -rf $HOME/miniconda3/envs/hosts
          else
            echo "Installing Miniconda..."
            rm -rf $HOME/miniconda3
          
            wget http://repo.continuum.io/miniconda/Miniconda3-latest-MacOSX-x86_64.sh -O miniconda.sh || exit 1
          
            bash miniconda.sh -b -p "$HOME/miniconda3" || exit 1
          fi
        - echo "Configuring Miniconda..."
        - conda config --set ssl_verify false || exit 1
        - conda config --set always_yes true --set changeps1 false || exit 1
        - echo "Updating Miniconda"
        - conda update conda
        - conda update --all
        - conda info -a || exit 1
        - echo "Creating a Python $PYTHON_VERSION environment"
        - conda create -n hosts python=$PYTHON_VERSION || exit 1
        - source activate hosts

    - os: windows
      language: sh
      before_install:
      - choco install python
      - python -m pip install --upgrade pip
      - export PATH="/c/Python37:/c/Python37/Scripts:$PATH"
    - os: linux
  allow_failures:
    - python: '2.7'
    - os: windows

script:
  - pip install -r requirements.txt
  - pip install colp coveralls pytest-cov
  - pytest --cov colp test/test.py 
  - echo 'a=RGB(1,2,3)' | colp 
